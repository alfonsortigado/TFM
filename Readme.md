# Computer-aided drug design towards novel TRPM8 channel modulators
- Student: Alfonso Ortigado López
- Academic tutor: Maria Garrido Arandía
- Tutor: Mercedes Martín Martínez

This GitHub repository contains the codes used for the development of the Master Thesis in Computational Biology in the academic year 2022-23, carried out at the IQM centre of the CSIC. Two main blocks have been included in this repository:
-	Automation of the analysis of the results of docking studies.
-	QSAR ligand-based virtual screening.
Each block has been developed using different programming techniques and tools for its implementation and analysis of results.

## Automation of the analysis of the results of docking studies.
### Script Overview.py:
A thorough analysis of the induced fit docking studies (IFD) was carried out using scripts previously developed by the group. However, these scripts were not working properly, a careful inspection of the code showed that it was due to an update of Python packages and of the output files from the IFD studies. Therefore, we proceeded to updated the existing code in order to allow for its implementation in the docking studies. 

The IFD studies provide a series of ligand-TRPM8 complexes, with different location, orientations and conformations of the ligand in the orthosteric site of the protein, which is known as  poses.

In order to evaluate the IFD studies,  the script previously developed in the group, that I have updated as above indicated, carried out a clustering analysis for each ligand-TRPM8 complex, on the base of the ligands RMSD. Besides, it also identify the hydrogen bonds and pi-stacking  between the ligand and the protein for each pose. Then, a representative pose is selected for each cluster based on the highest number of hydrogen bonds present in the cluster.

The code produces a csv file, called Results.csv, that contains the following columns:
-	Compound: indicates the compound used in the docking study.
-	Cluster_Num: indicates the cluster number corresponding to each compound.
-	Cluster_Members: shows the cluster members, using the following nomenclature: "Compound + _ + PoseNumber".
-	Representative_Pose: indicates the representative pose of the cluster.
-	Interaction: indicates the type of interaction: hydrogen bonds, pi-stacking  between the protein and the ligand.
-	Residue: indicates the residue of the protein involved in the interaction.

It should be noted that for each representative pose within a cluster the output file has one row for each interaction between the ligand and the protein, which makes the table long and redundant. An example of the Resuts.csv file is shown in Table 1. 


**Table 1. Representative example of the Results.csv file**

| Compound | Cluster | Cluster_Members | Representative_Pose | Interaction | Residue |
| --- | --- | --- | --- | --- | --- |
| AMTB | 1 | AMTB_2, AMTB_4, AMTB_7 | AMTB_4 | HAccep nn | :741(ASN) |
| AMTB | 1 | AMTB_2, AMTB_4, AMTB_7 | AMTB_4 | HAccep nn | :1005(TYR) |
| AMTB | 1 | AMTB_2, AMTB_4, AMTB_7 | AMTB_4 | HDonor nc | :1004(GLU) |
| AMTB | 1 | AMTB_2, AMTB_4, AMTB_7 | AMTB_4 | PiFace | :1013(PHE) |
| AMTB | 1 | AMTB_2, AMTB_4, AMTB_7 | Others | HBond | :1008(ARG), :845(HID) |
| AMTB | 1 | AMTB_2, AMTB_4, AMTB_7 | Others | Pi | :745(TYR) |
| AMTB | 2 | AMTB_1 | AMTB_1 | HDonor cc | :835(ASP) |
| AMTB | 3 | AMTB_3 | AMTB_3 | HDonor cc | :1004(GLU) |
| AMTB | 3 | AMTB_3 | AMTB_3 | PiFace | :745(TYR) |
| AMTB | 4 | AMTB_5 | AMTB_5 | PiEdge | :748(PHE) |
| AMTB | 5 | AMTB_6 | AMTB_6 | HDonor nc | :781(ASP) |
| AMTB | 5 | AMTB_6 | AMTB_6 | HDonor cc | :782(GLU) |
| AMTB | 5 | AMTB_6 | AMTB_6 | PiEdge | :839(PHE) |
| AMTB | 5 | AMTB_6 | AMTB_6 | PiEdge | :1013(PHE) |
| AMTB | 6 | AMTB_8 | AMTB_8 | HDonor cc | :782(GLU) |
| AMTB | 6 | AMTB_8 | AMTB_8 | HDonor cc | :781(ASP) |
| AMTB | 6 | AMTB_8 | AMTB_8 | PiEdge | :839(PHE) |
| AMTB | 6 | AMTB_8 | AMTB_8 | PiEdge | :845(HID) |
| … | … | … | … | … | … |

The aim of the "Overview2023" code is to simplify the table information from the generated Result.csv file by reducing the number of rows and generating a new table. Each row of this new table contains the information of a single cluster. The output of this code is "Overview_results.csv".

The simplified table contains the following information Table 2:
-	Compound: indicates the name of the evaluated compound.
-	Cluster_Num: indicates the cluster number corresponding to each compound.
-	Cluster_Members: shows the members of the cluster, abbreviating their nomenclature to "P + pose number". The "P" refers to "pose".
-	Representative_Pose: indicates the representative pose of the cluster.
-	H_interactions: shows the total number of hydrogen bonds generated by the compound.
-	Pi_interactions: shows the total number of Pi interactions generated by the compound.
-	Residues: shows the total set of residues in the protein involved in the interaction with the ligand.


**Table 2. Example of the Overview_results csv**

| Compound | Cluster_Num | Cluster_Memb | Representative_pose | H_interactions | Pi_Interactions | Residues |
| --- | --- | --- | --- | --- | --- | --- |
| AMTB | 2 | P1 | P1 | 1 | 0 | 835(ASP) |
| AMTB | 3 | P3 | P3 | 1 | 1 | 1004(GLU), 745(TYR) |
| AMTB | 4 | P5 | P5 | 0 | 1 | 748(PHE) |
| AMTB | 5 | P6 | P6 | 2 | 2 | 781(ASP), 782(GLU), 839(PHE), 1013(PHE) |
| AMTB | 6 | P8 | P8 | 2 | 2 | 782(GLU), 781(ASP), 839(PHE), 845(HID) |
| … | … | … | … | … | … | … |


Before executing the code, a folder must be created, containing the "Result.csv" file, which will be  input datafile. To execute the code, the following command is used from the terminal:

> run Overview2023.py

Upon execution, the program will ask for the location of the mentioned folder. Once this location is entered, the code will detect the file and perform the file conversion.

### Script FindIFDScore2023.py:

IFD studies provided a series of protein-ligand complex ordered by the IFDscore. However, in the results file obtained from the group's scripts, Result.csv, there is no information regarding the score of each pose. The aim of this FindIFDScore2023.py code is, to add to the output "Overview.csv", generated in the previous section, the score assigned to each cluster representative pose and to order the clusters according to the value added.

This code requires a file containing the information of the IFDscore for all the protein-ligand complex. To this end from Maestro, the visual interface of the Schrodinger suite of programs, it is necessary to export the IFD_spreadsheet (Table 3). The path to download this file is as follows, within the Maestro interface: 
open the Project Table section, go to the 'Data' > 'Export' > 'Spreadsheet...' section. 

**Table 3. Example of several rows of the IFD_spreadsheet**

| Title | IFDScore | Entry ID | Entry Name | Date Added | Date Modified | PDB format version | … |
| --- | --- | --- | --- | --- | --- | --- | --- |
| FP255_S | -470.62 | 4 | Structure9 | 13/3/23 17:16 | 14/3/23 13:31 | 3 | … |
| FP255_S | -467.2 | 5 | Structure9 | 13/3/23 17:16 | 14/3/23 13:43 | 3 | … |
| FP255_R | -464.82 | 6 | Structure9 | 13/3/23 17:16 | 14/3/23 13:47 | 3 | … |
| FP255_R | -464.25 | 7 | Structure9 | 13/3/23 17:16 | 14/3/23 13:48 | 3 | … |
| FP255_R | -464.21 | 8 | Structure9 | 13/3/23 17:16 | 14/3/23 13:49 | 3 | … |
| FP255_R | -464.09 | 9 | Structure9 | 13/3/23 17:16 | 14/3/23 13:51 | 3 | … |
| FP255_R | -461.92 | 12 | Structure9 | 13/3/23 17:16 | 14/3/23 13:53 | 3 | … |
| FP255_R | -461.91 | 13 | Structure9 | 13/3/23 17:16 | 14/3/23 13:54 | 3 | … |
| FP255_R | -460.85 | 18 | Structure9 | 13/3/23 17:16 | 14/3/23 14:01 | 3 | … |
| … | … | … | … | … | … | … | … |


Before executing the code, a folder must be created, containing the following files, which will be used as inputs for this script:
-	Overview_results.csv
-	IFD_spreadsheet.csv
To execute the code, the following command is used from the terminal:

> run FindIFDScore2023.py

Upon execution, the program will request the location of the mentioned folder. Once this location is entered, the code will detect the files and generate a new file with an embedded IFD value. The content of the output is shown in table 4. 

**Table 4. Example output content of FinfIFDScore2023.py script**

| Compound | Representative_pose | IFDScore | H_bonds | Pi_bonds | Cluster_Memb | Residues |
| --- | --- | --- | --- | --- | --- | --- |
| AMTB | P1 | -472.56 | 2 | 0 | P1 | 741(ASN), 1005(TYR) |
| AMTB | P2 | -470.62 | 2 | 1 | P2 | 781(ASP), 782(GLU), 839(PHE), |
| AMTB | P3 | -467.2 | 0 | 1 | P3 | 835(ASP) |
| C3 | P1 | -464.82 | 3 | 1 | P1, P2, P3, P4 | 781(ASP), 782(GLU), 839(PHE), 1013(PHE) |
| C3 | P5 | -461.92 | 2 | 0 | P5 | 1004(GLU), 745(TYR) |
| C3 | P6 | -461.91 | 3 | 1 | P6 | 741(ASN), 1005(TYR), 1004(GLU), 1013(PHE) |
| C3 | P7 | -460.85 | 5 | 3 | P7 | 741(ASN), 1005(TYR), 1004(GLU), 1013(PHE), 781(ASP), 782(GLU), 839(PHE), 1013(PHE) |
| TC-I | P1 | -462.16 | 2 | 0 | P1, P2, P7 | 781(ASP), 782(GLU) |
| … | … | … | … | … | … | … |



### Script RenameInsideMAE2023.py

The script used by the group to carry out the molecular docking analysis (IFD) produces a series of files with extension ".mae", which correspond to the representative poses obtained during the analysis. These files are named using the convention "Compound + _ + PoseNumber". The problem is that the modification of the file title is only reflected in the file name and is not saved when imported into the Schrödinger Maestro program, which causes the loss of the representative pose number. The aim is to implement an internal modification to each file to ensure that the correct name is retained.

This code has the function of updating the file names in a folder containing files with the extension ".mae".

First, it prompts the user to enter the path to the folder where the ".mae" files are located. Then, it iterates over each file in the folder and checks if it has the ".mae" extension. If the file has the extension, open the file and look for the line where the compound name information begins.

Once it finds this line, replace the next line with the name of the file (indicating which pose that structure represents) and the next line after that with an empty string (indicating that it does not belong to any group in master). Finally, it writes the updated lines back into the file. The code updates the filename in the ".mae" files in the specified folder.

## QSAR ligand-based virtual screening

A Python notebook file called TRPM8_QSAR can be found in the GitHub repository. This file is used for predicting the affinity of small molecules towards a specific target protein, using the input SMILES as parameters.

The file contains a detailed explanation of how this code works, including the tools and programming libraries used, as well as the process of analysis and visualisation of the results obtained.
